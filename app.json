[{"name": "app.py", "content": "from email.mime.multipart import MIMEMultipart\nfrom email.mime.text import MIMEText\nimport os\nfrom shiny import App, reactive, render, ui\nimport smtplib\n\n# Get GMAIL password from GitHub Secrets\n# GMAIL_PASS = dict(os.environ)['GMAIL_PASS']\n\napp_ui = ui.page_fluid(\n    ui.row(\n        ui.column(4),\n        ui.column(\n            4,\n            ui.h1(\"Contact Form\", style=\"text-align:center; padding-top:1%;\"),\n            ui.br(),\n            \"\"\"\n            Thanks for visiting my awesome contact form! If you want to drop me\n            a line and let me know just how much you love it, simply fill out\n            the form below and I'll be in touch with you never.\n            \"\"\",\n            ui.hr(),\n            ui.input_text(\n                id=\"userName\",\n                label=ui.span(\"Name\", ui.span(\"*\", style=\"color:red\")),\n                placeholder=\"John Doe\",\n                width=\"100%\"\n            ),\n            ui.input_text(\n                id=\"userPhone\",\n                label=\"Phone Number\",\n                placeholder=\"(123) 456-7890\",\n                width=\"100%\"\n            ),\n            ui.input_text(\n                id=\"userEmail\",\n                label=ui.span(\"Email\", ui.span(\"*\", style=\"color:red\")),\n                placeholder=\"john.doe@gmail.com\",\n                width=\"100%\"\n            ),\n            ui.input_text_area(\n                id=\"userMessage\",\n                label=ui.span(\n                    \"Message\",\n                    ui.span(\"*\", style=\"color:red\")\n                ),\n                width=\"100%\"\n            ),\n            ui.help_text(\n                ui.span(\n                    ui.span(\"*\", style=\"color:red\"),\n                    \"Indicates required field\"\n                ),\n                ui.br()\n            ),\n            ui.br(),\n            ui.input_action_button(\n                id=\"userSubmit\",\n                label=\"Submit\",\n                width=\"100%\",\n                style=\"background-color:#4caf50; color:white;\"\n            ),\n            align=\"justify\"\n        ),\n        ui.column(4)\n    ),\n    title=\"Contact Form\"\n)\n\ndef server(input, output, session):\n    @reactive.Calc\n    def send_email():\n        user_name = input.userName()\n        user_name = input.userName()\n        user_phone = input.userPhone()\n        user_email = input.userEmail()\n        user_message = input.userMessage()\n        # Don't allow submission of the form if required fields are empty\n        if user_name == \"\":\n            submit_status = ui.help_text(\n                ui.span(ui.HTML(\"<b>Name is missing</b>\"), style=\"color:red;\"),\n                id=\"submitStatus\"\n            )\n            return submit_status\n        elif user_email == \"\":\n            submit_status = ui.help_text(\n                ui.span(ui.HTML(\"<b>Email is missing</b>\"), style=\"color:red;\"),\n                id=\"submitStatus\"\n            )\n            return submit_status\n        elif user_message == \"\":\n            submit_status = ui.help_text(\n                ui.span(ui.HTML(\"<b>Message is missing</b>\"), style=\"color:red;\"),\n                id=\"submitStatus\"\n            )\n            return submit_status\n        # Construct and send email\n        mail_content = (\n            f\"Name : {user_name}\"\n            + f\"\\nPhone Number : {user_phone}\"\n            + f\"\\nEmail : {user_email}\"\n            + f\"\\n{'-'*80}\"\n            + f\"\\n{user_message}\"\n        )\n        sender_address = \"molitdj97@gmail.com\"\n        sender_pass = \"bmvhkghdjybscimg\"\n        receiver_address = \"molitdj97@gmail.com\"\n        message = MIMEMultipart()\n        message['From'] = sender_address\n        message['To'] = receiver_address\n        message['Subject'] = f\"Personal Website Contact Form - {user_name}\"\n        message.attach(MIMEText(mail_content, 'plain'))\n        session = smtplib.SMTP('smtp.gmail.com', 587)\n        session.starttls()\n        session.login(sender_address, sender_pass)\n        text = message.as_string()\n        session.sendmail(sender_address, receiver_address, text)\n        session.quit()\n        # Return confirmation to user\n        submit_status = ui.help_text(\n            ui.span(ui.HTML(\"<b>Form submitted successfully!</b>\"), style=\"color:blue;\"),\n            id=\"submitStatus\"\n        )\n        return submit_status\n    \n    @reactive.Effect\n    @reactive.event(input.userSubmit)\n    def _():\n        btn_value = input.userSubmit()\n        email_status = send_email()\n        if btn_value > 0:\n            ui.remove_ui(\"#submitStatus\")\n        ui.insert_ui(ui=email_status, selector=\"#userSubmit\", where=\"afterEnd\")\n\napp = App(app_ui, server)\n", "type": "text"}]